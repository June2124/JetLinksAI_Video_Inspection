# JetLinksAI Video Inspection

多路视频智能巡检与离线视频解析后端服务，支持 **RTSP 实时流** 与 **本地音/视频文件**，在 **边缘盒子（Sophon TPU）** 或云端运行 **VLM + ASR**，输出结构化安防事件与多模态摘要，通过 **SSE** 推送给上层平台。

---

## 🚀 项目定位

作为企业级 **「视频智能巡检能力层」**，聚焦解决：

- 多路 RTSP 统一管理与轮询巡检
- 视频按时间窗口切片 + 自适应关键帧抽取
- 本地/云端 VLM 安防事件检测与画面理解
- 本地/云端 ASR 语音转写
- 利用算能边缘计算盒子Sophon SDK 部署的本地Bmodel模型, 完成视觉描述与安防任务

典型应用：工厂 / 园区 / 楼宇安防巡检、大规模历史视频离线分析、边缘端多模态推理服务。

---

## ✨ 核心特性 & 技术亮点

- **多路 RTSP 轮询**
  - 支持 **2–50 路摄像头** 轮询
  - 每路可独立设置 切窗个数、系统提示词
  - 运行时可动态增删流、调整轮询间隔

- **多模态流水线**
  - 视频切片 + 关键帧抽取 → VLM 推理 → ASR 转写
  - 支持本地 Qwen-VL（Sophon TPU）与云端 VLM 切换
  - 支持本地 / 云端 ASR，统一输出时序文本

- **安防场景抽象**
  - 内置 系统提示词，覆盖 10 个安防/合规场景
  - 每个场景 3 条监督目标，统一事件结构与严格JSON输出格式

- **自适应性能调节**
  - 本地多模态模型运行时状态机能够基于推理延迟自动调整：
    - 切片窗口 `cut_window_sec`
    - 轮询间隔 `polling_batch_interval`
  - 面向算力受限设备的稳定运行能力

- **工程化与扩展性**
  - 基于 FastAPI + Pydantic，配置严格校验
  - 多队列 + `_STOP` 标识的 Worker 事件总线协调，支持暂停/恢复/优雅退出
  - SSE 事件总线易于对接前端与 IoT 平台

---

## 🗺️ 架构概览
![系统极简架构图](./system_architecture)

## 4. 运行模式
- OFFLINE：离线音/视频解析
- SECURITY_SINGLE：单路 RTSP 常驻安防巡检
- SECURITY_POLLING：多流RTSP轮询安防巡检

## 5. 流水线与 Worker 简述
